---
layout: post
title: a post with math
date: 2025-08-24 11:12:00-0400
description: an example of a blog post with some math
tags: formatting math
categories: sample-posts
related_posts: false
chart:
  chartjs: true
---

<small>*Disclaimer: All information in this post is publicly available, either in the Independent Rikers Commission (a.k.a., Lippman Commission) [report](https://static1.squarespace.com/static/5b6de4731aef1de914f43628/t/67dd7c6d4e5dca1fa86db6d8/1742568562268/Independent+Rikers+Commission+Blueprint+to+Close+Rikers+Island+March+2025.pdf) or in the [report](https://www.vitalcitynyc.org/articles/the-citys-new-rikers-math) that I authored while working as Assistant Commissioner of Operations Research, that was made public through a Freedom of Information Act (FOIA) request made by the Nonprofit Vital City. Moreover, the contents of this post are only my opinions and do not represent the views of the city or any other entity I am or was affiliated with.* </small>

> Operations research is a scientiﬁc method of providing executive departments with a quantitative basis for
decisions regarding operations under their control.

Out of all the definitions of Operations Research, this is the one I like most. It really comprises the quantitative spirit of the discipline while emphasizing that ultimately, the goal is problem solving. The quote is attributed to Philip M. Morse (the father or OR in the U.S.) in a John D. Little's [article](https://pubsonline.informs.org/doi/epdf/10.1287/opre.50.1.146.17799) commemorating the 50th anniversary of the Operations Research Journal.

## Some Background

In this post, we talk about connecting one of Little's key discoveries (his eponymous law) and a very relevant set of problems that are in great need of OR solutions. Out of these problems, Rikers Island has been infamously at the center of innumerable controversies and plagued with problems since its construction. The aim of this post is not to comment on the social and justice aspects of the NYC correctional system, but rather talk about a common set of challenges that stochastic systems (such as Rikers Island) face because of their scale, and some quantitative strategies to guide urban planning for either replace existing facilities or build new ones.

As a motivation and context to this problem, Rikers is set to be closed by 2027 and replaced by different facilities in each borough. When this plan was set into law in 2019, the population of Rikers was in a steady decline, and it was then decided that 3,300 beds was enough capacity for the new facilities. Long-story short, a combination of factors including the pandemic, a different set of bail-laws and patterns of crime have set the population in the opposite direction. As part of my work I was tasked with creating projections of the population in the future in a data-driven way back in 2022-23. This post is a commentary on that analysis, which I believe has value beyond correctional facilities, and can be applied to many large scale stochastic systems (such as airports, traffic roads and so on).

## The Forecast Challenge and the Connection with Little's Law

Rikers (or any correctional facility) is a stochastic system where there is a series of arrivals that stay a random amount of time (in this case, pretrial cases) before exiting the system. Little's law is the swiss knife of a scientist studying stochastic systems. The simplicity and beauty of the formula $$L=\lambda w$$, expressing that the average number in the system $$ L $$ is equal to their arrival rate $$\lambda$$ times the average waiting time $$w$$ provides simple answer to in general a difficult question.

While an incredibly useful relation, it doesn't apply then the arrival rate is time-varying and not converging to an average value in the long-term. As part of the task of building a prediction model for the future population in the system, I went back to the proof of Little's law to understand the mechanics on how to modify it to the time-varying case and making it transient. Here, transience refers to the ability to have forecasts per month into the future, this is important as the population and arrivals exhibit heavy seasonality.

This study led to this modified version of Little's law for time-varying arrival rates:

>#### Theorem: Average Population in System for Time-varying Arrival Rates (a transient Little's Law)
>
>Consider a discrete time stochastic system with time indexed as $$ t=0,1,2,\dots $$ with arrivals given by arbitrary rates $$ \lambda_1,\lambda_2 $$ where arrivals spend an average time $w$ in the system. The average number in the system $$ L_t $$ at time $$ t $$ is given by:
>
>$$
>L_t = (1-e^{-1/w})\lambda_t w +e^{-1/w}L_{t-1}
>$$

The theorem states that the average number in the system is a combination of what's implied by Little's law $$\lambda_t w$$ plus the number in the system the previous period that haven't completed their time in the system. Remarkably this retrieves the original Little's law in the case where $\lambda_1=\lambda_2=...$ and also in the case where $$w\rightarrow 0$$ (meaning that the service is fast enough for the number in system to converge to the quantity implied by Little's law before the rate changes). Lastly, in the case where the arrival rates converge, again Little's law is retrieved.

## Predicting the Population at Rikers

The previous theorem is useful in two ways: on one hand it provides a way to predict the future population by modeling the arrival rates (say, with a time-series model); on the other, and more importantly, it also provides a model that can quantify how changes in policy (recall that the average time in the system $$w$$ is determined by the time the case takes to process) change the average number in population. This is specially useful to quantify how speeding up the court system can do to reduce or change the population at Rikers, the kind of analysis that while hinted intuitively in the Lippman report, is lacking a quantitative basis.

Using this model, we forecasted the arrival rates as a time series model $$ \hat\lambda_t = f(\lambda_{t_1}) $$ and used the result in our Theorem. This exercise produced the following results:

```chartjs
{
  "type": "line",
  "data": {
    "labels": [
      "2023-02-01",
      "2023-03-01",
      "2023-04-01",
      "2023-05-01",
      "2023-06-01",
      "2023-07-01",
      "2023-08-01",
      "2023-09-01",
      "2023-10-01",
      "2023-11-01",
      "2023-12-01",
      "2024-01-01",
      "2024-02-01",
      "2024-03-01",
      "2024-04-01",
      "2024-05-01",
      "2024-06-01",
      "2024-07-01",
      "2024-08-01",
      "2024-09-01",
      "2024-10-01",
      "2024-11-01",
      "2024-12-01",
      "2025-01-01",
      "2025-02-01",
      "2025-03-01",
      "2025-04-01",
      "2025-05-01",
      "2025-06-01"
    ],
    "datasets": [
      {
        "label": "Expected Population",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(75,192,192,0.4)",
        "borderColor": "rgba(75,192,192,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(75,192,192,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(75,192,192,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
          5829.94,
          5866.9,
          5708.24,
          5844.03,
          5888.77,
          6071.46,
          6218.77,
          6432.59,
          6613.27,
          6531.51,
          6378.37,
          6480.73,
          6500.96,
          6601.87,
          6494.85,
          6672.93,
          6752.78,
          6965.04,
          7137.57,
          7373.15,
          7572.79,
          7507.74,
          7369.42,
          7485.02,
          7517.15,
          7628.8,
          7531.52,
          7718.45,
          7806.38
        ],
        "spanGaps": false
      },
      {
        "label": "Actual Population",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(255,99,132,0.4)",
        "borderColor": "rgba(255,99,132,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(255,99,132,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(255,99,132,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
          5921,
          5911,
          5943,
          6018,
          6044,
          6152,
          6181,
          6179,
          6171,
          6148,
          6072,
          6109,
          6151,
          6285,
          6324,
          6315,
          6376,
          6386,
          6440,
          6512,
          6573,
          6626,
          6605,
          6603,
          6760,
          6982,
          7264,
          7517,
          7611
        ],
        "spanGaps": false
      },
      {
        "label": "Confidence Interval",
        "fill": "+1",
        "backgroundColor": "rgba(128, 128, 128, 0.2)",
        "borderColor": "transparent",
        "pointBorderColor": "transparent",
        "pointBackgroundColor": "transparent",
        "data": [
          5500.52,
          5367.83,
          5081.43,
          5116.54,
          5081.53,
          5199.87,
          5295.09,
          5466.24,
          5611.88,
          5501.66,
          5325.06,
          5407.49,
          5411.21,
          5498.15,
          5379.76,
          5547.81,
          5619.36,
          5824.38,
          5990.81,
          6221.11,
          6416.29,
          6347.85,
          6206.81,
          6319.72,
          6349.69,
          6459.37,
          6360.74,
          6546.08,
          6632.77
        ]
      },
      {
        "label": "C.I. Upper",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(255,206,86,0.4)",
        "borderColor": "transparent",
        "pointBorderColor": "transparent",
        "pointBackgroundColor": "transparent",
        "data": [
          6159.36,
          6365.96,
          6335.05,
          6571.53,
          6696.01,
          6943.04,
          7142.45,
          7398.95,
          7614.65,
          7561.36,
          7431.67,
          7553.96,
          7590.72,
          7705.59,
          7609.95,
          7798.05,
          7886.21,
          8105.7,
          8284.32,
          8525.19,
          8729.3,
          8667.62,
          8532.02,
          8650.31,
          8684.62,
          8798.24,
          8702.31,
          8890.83,
          8979.98
        ],
        "spanGaps": false
      }
    ]
  },
  "options": {
    "responsive": true,
    "maintainAspectRatio": false,
    "scales": {
      "y": {
        "min": 4827,
        "max": 9429
      }
    }
  }
}
```

This theme supports rendering beautiful math in inline and display modes using [MathJax 3](https://www.mathjax.org/) engine. You just need to surround your math expression with `$$`, like `$$ E = mc^2 $$`. If you leave it inside a paragraph, it will produce an inline expression, just like $$ E = mc^2 $$.

To use display mode, again surround your expression with `$$` and place it as a separate paragraph. Here is an example:

$$
\sum_{k=1}^\infty |\langle x, e_k \rangle|^2 \leq \|x\|^2
$$

You can also use `\begin{equation}...\end{equation}` instead of `$$` for display mode math.
MathJax will automatically number equations:

\begin{equation}
\label{eq:cauchy-schwarz}
\left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right)
\end{equation}

and by adding `\label{...}` inside the equation environment, we can now refer to the equation using `\eqref`.

Note that MathJax 3 is [a major re-write of MathJax](https://docs.mathjax.org/en/latest/upgrading/whats-new-3.0.html) that brought a significant improvement to the loading and rendering speed, which is now [on par with KaTeX](http://www.intmath.com/cg5/katex-mathjax-comparison.php).
